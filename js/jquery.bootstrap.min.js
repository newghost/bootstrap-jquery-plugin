/**
* jquery.bootstrap.js
Copyright (c) Kris Zhang <kris.newghost@gmail.com>
License: MIT (https://github.com/newghost/bootstrap-jquery-plugin/blob/master/LICENSE)
*/
String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(a,o){return"undefined"!=typeof t[o]?t[o]:a})}),function(t){t.fn.dialog=function(a){var o=this,e=t(o),n=(t(document.body),e.closest(".dialog")),s="dialog-parent",r=arguments[1],d=arguments[2],i=function(){var a='<div class="dialog modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close">&times;</button><h4 class="modal-title"></h4></div><div class="modal-body"></div><div class="modal-footer"></div></div></div></div>';n=t(a),t(document.body).append(n),n.find(".modal-body").append(e)},l=function(e){var s=(e||a||{}).buttons||{},r=n.find(".modal-footer");r.html("");for(var d in s){var i=s[d],l="",c="",u="btn-default",f="";i.constructor==Object&&(l=i.id,c=i.text,u=i["class"]||i.classed||u,f=i.click),i.constructor==Function&&(c=d,f=i),$button=t('<button type="button" class="btn {1}">{0}</button>'.format(c,u)),l&&$button.attr("id",l),f&&!function(t){$button.click(function(){t.call(o)})}(f),r.append($button)}r.data("buttons",s)},c=function(){n.modal("show")},u=function(t){n.modal("hide").on("hidden.bs.modal",function(){t&&(e.data(s).append(e),n.remove())})};if(a.constructor==Object&&(!e.data(s)&&e.data(s,e.parent()),n.size()<1&&i(),l(),t(".modal-title",n).html(a.title||""),t(".modal-header .close",n).click(function(){var t=a.onClose||u;t.call(o)}),(a["class"]||a.classed)&&n.addClass(a["class"]||a.classed),a.autoOpen!==!1&&c()),"destroy"==a&&u(!0),"close"==a&&u(),"open"==a&&c(),"option"==a&&"buttons"==r){if(!d)return n.find(".modal-footer").data("buttons");l({buttons:d}),c()}return o}}(jQuery),$.messager=function(){var t=function(t,a,o){var e=$.messager.model;arguments.length<2&&(a=t||"",t="&nbsp;"),$("<div>"+a+"</div>").dialog({title:t,onClose:function(){$(this).dialog("destroy")},buttons:[{text:e.ok.text,classed:e.ok.classed||"btn-success",click:function(){$(this).dialog("destroy"),o&&"function"==typeof o&&o()}}]})},a=function(t,a,o){var e=$.messager.model;$("<div>"+a+"</div>").dialog({title:t,onClose:function(){$(this).dialog("destroy")},buttons:[{text:e.ok.text,classed:e.ok.classed||"btn-success",click:function(){$(this).dialog("destroy"),o&&o()}},{text:e.cancel.text,classed:e.cancel.classed||"btn-danger",click:function(){$(this).dialog("destroy")}}]})};return{alert:t,confirm:a}}(),$.messager.model={ok:{text:"OK",classed:"btn-success"},cancel:{text:"Cancel",classed:"btn-danger"}},function(t){t.fn.datagrid=function(a,o){var e=this,n="success",s=t(this),r=function(a){var o=s.data("config"),e=o.selectChange,r=o.singleSelect,d=o.edit,i=function(a){var o=t(this),d=o.hasClass(n),i=t("tbody tr",s).index(o),l=s.data("rows")[i]||{};r&&t("tbody tr",s).removeClass(n),o.toggleClass(n),e&&e(!d,i,l,o)};(e||"undefined"!=typeof r)&&a.click(i);var l=function(a){var o=t(this),e=o.closest("tr"),n=t("tbody tr",s).index(e),r=s.data("rows")[n]||{},d=o.attr("name");d&&(r[d]=o.val())};d&&a.find("input").keyup(l)},d=function(t,a,o){for(var e="<tr>",n=0,s=t[0].length;s>n;n++){var r=t[0][n],d=r.formatter,i=r.field,l=(r.tip,a[i]),c=r.maxlength,u=r.readonly;"undefined"==typeof l&&(l=""),o.edit&&(c=c?' maxlength="{0}"'.format(r.maxlength):"",u=u?' readonly="readonly"':"",l='<input name="{0}" value="{1}" class="form-control"{2}{3}/>'.format(r.field,l,c,u)),l=d?d(a[i],a):l,e=e+"<td>"+l+"</td>"}return e+="</tr>"},i=function(a){if(o){var e=s.data("config")||{},n=e.columns,i=o.rows||o,l="<tbody>";if(i)for(var c=0,u=i.length;u>c;c++)l+=d(n,i[c],e);l+="</tbody>",t("tbody",s).remove(),s.data("rows",i).append(l),e.edit&&s.addClass("edit"),r(t("tbody tr",s))}};if(a&&a.constructor==Object){var l=a.columns;if(l){t("thead",s).size()<1&&s.append("<thead></thead>");for(var c="<tr>",u=0,f=l[0].length;f>u;u++){var m=l[0][u];c+="<th>"+(m.title||"")+"</th>"}c+="</tr>",s.data("config",a),t("thead",s).html(c)}}if("loadData"==a&&i(),"getData"==a)return s.data("rows");if("getConfig"==a)return s.data("config");if("getColumns"==a)return s.data("config").columns;if("unselectRow"==a&&("undefined"!=typeof o?t("tbody tr",s).eq(o).removeClass(n):t("tbody tr",s).removeClass(n)),"updateRow"==a){var p=o.index,v=s.data("config"),h=s.data("rows"),g=o.row,l=v.columns;h&&(g=t.extend(h[p],g),s.data("rows",h));var y=t(d(l,g,v));t("tbody tr",s).eq(p).after(y).remove(),r(y)}if("getSelections"==a){var h=s.data("rows"),b=[];return t("tbody tr",s).each(function(a){t(this).hasClass(n)&&b.push(h[a])}),b}if("insertRow"==a){var p=o.index||0,g=o.row,v=s.data("config"),h=s.data("rows")||[];if(!v||!g)return s;var C=t("tbody tr",s),y=t(d(v.columns,g,v)),x=C.eq(p);r(y),x.size()?x.before(y):t("tbody",s).append(y),h.splice(p,0,g)}if("deleteRow"==a&&o>-1){t("tbody tr",s).eq(o).remove();var h=s.data("rows");h.splice(o,1)}return e}}(jQuery),function(t){t.fn.tree=function(a,o){var e=this,n=t(e),s=Array.prototype.push,r="glyphicon-file",d="glyphicon-folder-open",i="glyphicon-folder-close",l=function(t,a,o){var e=[];!a&&e.push('<ul style="display:{0}">'.format("close"==o?"none":"block"));for(var n=0,c=t.length;c>n;n++){var u=t[n],f=u.children,m=u.id,p=u.state,v=u.attributes;e.push("<li>");var h="undefined"==typeof f?r:"close"==p?i:d;e.push('<span class="glyphicon {0}"></span> '.format(h)),e.push("<a{1}{2}{3}>{0}</a>".format(u.text,f?" class='tree-node'":"",m?" data-id='{0}'".format(m):"",v?" data-attr='{0}'".format(JSON.stringify(v)):"")),f&&s.apply(e,l(f,!1,p)),e.push("</li>")}return!a&&e.push("</ul>"),e},c=function(){t("span.glyphicon-folder-open, span.glyphicon-folder-close",n).click(function(a){var o=t(this),e=o.closest("li").children("ul");o.hasClass(i)?(o.removeClass(i).addClass(d),e.show()):(o.removeClass(d).addClass(i),e.hide())})};if(a&&a.constructor==Object){var u=a.data;if(u&&u.constructor==Array){var f=l(u,!0);n.html(f.join("")),n.data("config",a),c()}var m=a.onClick;m&&t("li>a",n).click(function(){var a=t(this);attrs=a.attr("data-attr"),m.call(e,{id:a.attr("data-id"),attributes:attrs?JSON.parse(attrs):{},text:a.text()},a)})}return e}}(jQuery);