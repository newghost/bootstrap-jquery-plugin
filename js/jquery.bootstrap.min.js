/**
* jquery.bootstrap.js
Copyright (c) Kris Zhang <kris.newghost@gmail.com>
License: MIT (https://github.com/newghost/bootstrap-jquery-plugin/blob/master/LICENSE)
*/
String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return typeof e[n]!="undefined"?e[n]:t})}),function(e){e.fn.dialog=function(t){var n=this,r=e(n),i=e(document.body),s=r.closest(".dialog"),o="dialog-parent",u=arguments[1],a=arguments[2],f=function(){var t='<div class="dialog modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close">&times;</button><h4 class="modal-title"></h4></div><div class="modal-body"></div><div class="modal-footer"></div></div></div></div>';s=e(t),e(document.body).append(s),s.find(".modal-body").append(r)},l=function(r){var i=(r||t||{}).buttons||{},o=s.find(".modal-footer");o.empty();var u=i.constructor==Array;for(var a in i){var f=i[a],l="",c="",h="btn-default",p="";if(f.constructor==Object)l=f.id,c=f.text,h=f["class"]||f.classed||h,p=f.click;else{if(!!u||f.constructor!=Function)continue;c=a,p=f}$button=e('<button type="button" class="btn">').addClass(h).html(c),l&&$button.attr("id",l),p&&function(e){$button.click(function(){e.call(n)})}(p),o.append($button)}o.data("buttons",i)},c=function(){s.modal("show")},h=function(e){s.modal("hide").one("hidden.bs.modal",function(){e&&(r.data(o).append(r),s.remove())})};if(t.constructor==Object){!r.data(o)&&r.data(o,r.parent()),s.size()<1&&f(),l(),e(".modal-title",s).html(t.title||"");var p=e(".modal-dialog",s);p.removeClass("modal-sm","modal-lg").addClass(t.dialogClass||""),e(".modal-header .close",s).click(function(){var e=t.onClose||h;e.call(n)}),(t["class"]||t.classed)&&s.addClass(t["class"]||t.classed),t.autoOpen===!1&&(t.show=!1),t.width&&p.width(t.width),t.height&&p.height(t.height),typeof t.padding!="undefined "&&s.find(".modal-body").css("padding",t.padding),s.modal(t)}t=="destroy"&&h(!0),t=="close"&&h(),t=="open"&&c();if(t=="option"&&u=="buttons"){if(!a)return s.find(".modal-footer").data("buttons");l({buttons:a}),c()}return n}}(jQuery),$.messager=function(){var e=function(e,t){var n=$.messager.model;arguments.length<2&&(t=e||"",e="&nbsp;"),$("<div>"+t+"</div>").dialog({title:e,onClose:function(){$(this).dialog("destroy")},buttons:[{text:n.ok.text,classed:n.ok.classed||"btn-success",click:function(){$(this).dialog("destroy")}}]})},t=function(e,t,n){var r=$.messager.model;$("<div>"+t+"</div>").dialog({title:e,onClose:function(){$(this).dialog("destroy")},buttons:[{text:r.ok.text,classed:r.ok.classed||"btn-success",click:function(){n&&n(),$(this).dialog("destroy")}},{text:r.cancel.text,classed:r.cancel.classed||"",click:function(){$(this).dialog("destroy")}}]})},n='<div class="dialog modal fade msg-popup"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-body text-center"></div><div class="modal-close-btn"><i class="glyphicon glyphicon-remove"></i></div></div></div></div>',r=$(".dialog.msg-popup"),i=function(e){r.size()||(r=$(n),$("body").append(r)),r.find(".modal-body").html(e),r.modal({show:!0,backdrop:!1}),r.on("click",function(e){if($(e.target).closest(".modal-body").size())return;$(this).remove()}),setTimeout(function(){r.remove()},6e4)};return{alert:e,popup:i,confirm:t}}(),$.messager.model={ok:{text:"OK",classed:"btn-success"},cancel:{text:"Cancel",classed:"btn-danger"}},function(e){e.fn.datagrid=function(t,n){var r=this,i=e(r),s=i.data("config")||{},o=i.data("rows")||[],u=s.selectedClass||"success",a=s.singleSelect,f=function(t){var n=s.selectChange,r=s.edit,f=function(t){var r=e(this),s=r.hasClass(u),f=e("tbody tr",i).index(r),l=o[f]||{};a&&e("tbody tr",i).removeClass(u),r.toggleClass(u),n&&n(!s,f,l,r)};(n||typeof a!="undefined")&&t.click(f)},l=function(){e("tbody tr",i).each(function(t){var n=e(this),r=o[t]||{};n.find("input[name]").each(function(){var t=e(this),n=t.attr("name");n&&(r[n]=t.val())}),o[t]=r})},c=function(e,t){var n="<tr>";s.rowClass&&(n='<tr class="'+s.rowClass+'">');for(var r=0,i=e[0].length;r<i;r++){var o=e[0][r],u=o.formatter,a=o.field,f=o.tip,l=t[a],c=o.maxlength,h=o.readonly;typeof l=="undefined"&&(l=""),s.edit&&(c=c?' maxlength="{0}"'.format(o.maxlength):"",h=h?' readonly="readonly"':"",l='<input name="{0}" value="{1}" class="form-control"{2}{3}/>'.format(o.field,l,c,h)),l=u?u(t[a],t):l,n=n+"<td>"+l+"</td>"}return n+="</tr>",n},h=function(t){if(!n)return;var r=s.columns;o=n.rows||n;if(!r)return;var u="<tbody>";if(o)for(var a=0,l=o.length;a<l;a++)u+=c(r,o[a]);u+="</tbody>",e("tbody",i).remove(),i.data("rows",o).append(u),s.edit&&i.addClass("edit"),f(e("tbody tr",i))},p=function(){if(n&&typeof n.index!="undefined")return[n.index];var t=[];return i.find("tbody tr").each(function(n){var r=e(this);r.hasClass(u)&&t.push(n)}),t};if(t&&t.constructor==Object){var d=t.columns;if(d){e("thead",i).size()<1&&i.append("<thead></thead>");var v="<tr>";for(var m=0,g=d[0].length;m<g;m++){var y=d[0][m];v+="<th>"+(y.title||"")+"</th>"}v+="</tr>",i.data("config",t),e("thead",i).html(v)}}t=="loadData"&&h();if(t=="getData")return l(),o;if(t=="getConfig")return s;if(t=="getColumns")return s.columns;if(t=="selectRow"){if(typeof a=="undefined")return;typeof n=="number"?(a&&i.datagrid("unselectRow"),e("tbody tr",i).eq(n).addClass(u)):a||e("tbody tr",i).addClass(u)}t=="unselectRow"&&(typeof n!="undefined"?e("tbody tr",i).eq(n).removeClass(u):e("tbody tr",i).removeClass(u));if(t=="updateRow"){var b=p(),w=n.row,d=s.columns;for(var m=0,g=b.length;m<g;m++){var E=b[m];o&&(w=e.extend(o[E],w));var S=e(c(d,w,s));typeof n.index=="undefined"&&S.addClass(u),e("tbody tr",i).eq(E).after(S).remove(),f(S)}}if(t=="getSelections"){var x=[];return l(),e("tbody tr",i).each(function(t){e(this).hasClass(u)&&x.push(o[t])}),x}if(t=="getSelectedIndex")return p();if(t=="insertRow"){var T=p()[0],w=n.row;if(typeof T=="undefined"||T<0)T=o.length;if(!s||!w)return i;var N=e("tbody tr",i),S=e(c(s.columns,w,s)),C=N.eq(T);f(S),C.size()?C.after(S):e("tbody",i).append(S),o.splice(T,0,w)}if(t=="deleteRow"){var b=typeof n=="number"?[n]:p();for(var m=b.length-1;m>-1;m--){var T=b[m];e("tbody tr",i).eq(T).remove(),o.splice(T,1)}}return r}}(jQuery),function(e){e.fn.tree=function(t,n){var r=this,i=e(r),s=Array.prototype.push,o="nav",u="active",a="selected",f="",l="",c="",h=function(e,n){var r=[];r.push('<ul class="{0} {1}">'.format(n?"":"tree-nav",o));for(var i=0,a=e.length;i<a;i++){var p=e[i],d=p.nodes,v=p.id,m=p.active,g=p.classed,y=p.attr,b=p.href,w=p.icon,E=p.itemClass||"";if(!d&&t.hideItem)continue;r.push('<li class="{0} {1} {2}">'.format(m?u:"",d&&d.length?"":"no-child",E)),icon='<i class="tree-icon {0} {1}"></i>'.format(w||(d?"glyphicon tree-folder":"glyphicon tree-item"),w?"":d?f:l);var S='<a{1}{2} class="{3}" data-path="{5}" title="{4}" href="{6}">{0}<span>{4}</span></a>'.format(n+icon,v?" id='{0}'".format(v):"",y?" data-attr='{0}'".format(JSON.stringify(y)):"",g||"",p.text,typeof p.path=="undefined"?p.text:p.path,b||"#");r.push(S),d&&s.apply(r,h(d,n+'<i class="tree-indent {0}"></i>'.format(c))),r.push("</li>")}return r.push("</ul>"),r},p=function(e){e||(e=i.find("."+a)),e.size()<1&&(e=i);if(e[0].tagName!="A"){var t=e.find(">a");e=t.size()?t:e.closest("a")}return e},d=function(e){e=p(e);var t=[],n=e.parents(),r=n.size();for(var i=0;i<r;i++){var s=n.eq(i);if(s.hasClass("tree-nav"))return t;if(s[0].tagName=="LI"){var o=s.find(">a");t.push({id:o.attr("id")||"",text:o.text(),path:o.data("path")||"",attr:JSON.parse(o.attr("data-attr")||"{}")})}}return t},v=function(t){t=p(t);var n=[];return t.parent().find(">ul>li>a").each(function(){var t=e(this);n.push({id:t.attr("id"),path:t.data("path"),text:t.text(),attr:JSON.parse(t.attr("data-attr")||"{}")})}),n},m=function(e){var t=[];for(var n=e.length-1;n>-1;n--){var r=e[n];t.push(r.path)}return t.join("/")},g=function(t){var n,r;if(typeof t=="string"){var s=[],o,a=t.split("/"),f;n=i.find(">ul");for(r=0;r<a.length;r++){f=a[r],f&&f!="#"?o=n.find('>li>[data-path="{0}"]'.format(f)):o=n.find(">li>[data-path]").filter(function(){return!e(this).data("path")});if(o.size()<1||o.data("path")!=f)return null;n=o.parent().find(">ul")}n=o.parent()}else n=t;n=p(n),n.click();var l=n.parents("li"),c=l.size();for(r=0;r<c;r++){var h=l.eq(r);h.addClass(u)}return n},y=function(e){var t=p();return typeof e.id!="undefined"&&t.attr("id",e.id),typeof e.path!="undefined"&&t.data("path",e.path),typeof e.text!="undefined"&&t.find("span").text(e.text),typeof e.attr!="undefined"&&t.data("attr",JSON.stringify(e.attr)),i},b=function(e){var t=p();return t.closest("a").remove(),i},w=function(t){var n=p();if(!n.size()||!t.length)return;var r=n.find(".tree-indent").size(),s="";for(var o=0;o<=r;o++)s+='<i class="tree-indent"></i>';var t=e(h(t,s).join("")).html();return n.closest("li").find(">ul").prepend(t),i};if(t&&t.constructor==Object){o=t.treeClass||o,u=t.activeClass||u,a=t.selectedClass||a,f=typeof t.folderIcon=="undefined"?f:t.folderIcon,l=typeof t.itemIcon=="undefined"?l:t.itemIcon,c=typeof t.indentIcon=="undefined"?c:t.indentIcon;var E=t.data;if(E&&E.constructor==Array){var S=h(E,"");i.html(S.join("")),i.data("config",t)}var x=t.onClick,T=function(){var t=e(this).closest("li");t.toggleClass(u)},N=function(n){var s=e(this),o=s.closest("li"),f=i.find("a."+a),l=s.attr("data-attr");f.removeClass(a),s.addClass(a),n.preventDefault(),n.target.tagName!="I"&&(o.hasClass(u)?t.closeOnClick!==!1&&o.removeClass(u):t.expandOnClick!==!1&&o.addClass(u));if(x){var c=d(s),h=m(c);x.call(r,n,{id:s.attr("id"),attr:l?JSON.parse(l):{},text:s.text(),nodes:c,path:h,href:s.attr("href")},s)}};i.off("click","li>a>i").on("click","li>a>i",T),i.off("click","li>a").on("click","li>a",N)}else{if(t=="getChildren")return v(n);if(t=="getParents")return d(n);if(t=="getPath")return m(d(n));if(t=="select")return g(n);if(t=="update")return y(n);if(t=="remove")return b(n);if(t=="insert")return w(n);if(t=="getSelected"){var C=p();return{id:C.attr("id"),text:C.find("span").text(),path:C.data("path"),attr:JSON.parse(C.data("attr")||"{}")}}if(t=="getSelectedNode")return p()}return r}}(jQuery)