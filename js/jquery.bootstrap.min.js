/**
* jquery.bootstrap.js
Copyright (c) Kris Zhang <kris.newghost@gmail.com>
License: MIT (https://github.com/newghost/bootstrap-jquery-plugin/blob/master/LICENSE)
*/
String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(a,e){return"undefined"!=typeof t[e]?t[e]:a})}),function(t){t.fn.dialog=function(a){var e=this,o=t(e),n=(t(document.body),o.closest(".dialog")),s="dialog-parent",r=function(){var a='<div class="dialog modal fade"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close">&times;</button><h4 class="modal-title"></h4></div><div class="modal-body"></div><div class="modal-footer"></div></div></div></div>';n=t(a),t(document.body).append(n),n.find(".modal-body").append(o)},d=function(){var o=a.buttons||{},s=n.find(".modal-footer");s.html("");for(var r in o){var d=o[r],i="",l="",c="btn-default",u="";d.constructor==Object&&(i=d.id,l=d.text,c=d["class"]||d.classed||c,u=d.click),d.constructor==Function&&(u=d),$button=t('<button type="button" class="btn {1}">{0}</button>'.format(l,c)),i&&$button.attr("id",i),u&&!function(t){$button.click(function(){t.call(e)})}(u),s.append($button)}},i=function(){n.modal("show")},l=function(t){n.modal("hide").on("hidden.bs.modal",function(){t&&(o.data(s).append(o),n.remove())})};return a.constructor==Object&&(!o.data(s)&&o.data(s,o.parent()),n.size()<1&&r(),d(),t(".modal-title",n).html(a.title||""),t(".modal-header .close",n).click(function(){var t=a.onClose||l;t.call(e)}),(a["class"]||a.classed)&&n.addClass(a["class"]||a.classed),a.autoOpen!==!1&&i()),"destroy"==a&&l(!0),"close"==a&&l(),"open"==a&&i(),e}}(jQuery),$.messager=function(){var t=function(t,a){var e=$.messager.model;arguments.length<2&&(a=t||"",t="&nbsp;"),$("<div>"+a+"</div>").dialog({title:t,onClose:function(){$(this).dialog("destroy")},buttons:[{text:e.ok.text,classed:e.ok.classed||"btn-success",click:function(){$(this).dialog("destroy")}}]})},a=function(t,a,e){var o=$.messager.model;$("<div>"+a+"</div>").dialog({title:t,onClose:function(){$(this).dialog("destroy")},buttons:[{text:o.ok.text,classed:o.ok.classed||"btn-success",click:function(){$(this).dialog("destroy"),e&&e()}},{text:o.cancel.text,classed:o.cancel.classed||"btn-danger",click:function(){$(this).dialog("destroy")}}]})};return{alert:t,confirm:a}}(),$.messager.model={ok:{text:"OK",classed:"btn-success"},cancel:{text:"Cancel",classed:"btn-danger"}},function(t){t.fn.datagrid=function(a,e){var o=this,n="success",s=t(this),r=function(a){var e=s.data("config"),o=e.selectChange,r=e.singleSelect,d=e.edit,i=function(){var a=t(this),e=a.hasClass(n),d=t("tbody tr",s).index(a),i=s.data("rows")[d]||{};r&&t("tbody tr",s).removeClass(n),a.toggleClass(n),o&&o(!e,d,i,a)};(o||"undefined"!=typeof r)&&a.click(i);var l=function(){var a=t(this),e=a.closest("tr"),o=t("tbody tr",s).index(e),n=s.data("rows")[o]||{},r=a.attr("name");r&&(n[r]=a.val())};d&&a.find("input").keyup(l)},d=function(t,a,e){for(var o="<tr>",n=0,s=t[0].length;s>n;n++){var r=t[0][n],d=r.formatter,i=r.field,l=(r.tip,a[i]),c=r.maxlength,u=r.readonly;"undefined"==typeof l&&(l=""),e.edit&&(c=c?' maxlength="{0}"'.format(r.maxlength):"",u=u?' readonly="readonly"':"",l='<input name="{0}" value="{1}" class="form-control"{2}{3}/>'.format(r.field,l,c,u)),l=d?d(a[i],a):l,o=o+"<td>"+l+"</td>"}return o+="</tr>"},i=function(){if(e){var a=s.data("config")||{},o=a.columns,n=e.rows||e,i="<tbody>";if(n)for(var l=0,c=n.length;c>l;l++)i+=d(o,n[l],a);i+="</tbody>",t("tbody",s).remove(),s.data("rows",n).append(i),a.edit&&s.addClass("edit"),r(t("tbody tr",s))}};if(a&&a.constructor==Object){var l=a.columns;if(l){t("thead",s).size()<1&&s.append("<thead></thead>");for(var c="<tr>",u=0,f=l[0].length;f>u;u++){var v=l[0][u];c+="<th>"+(v.title||"")+"</th>"}c+="</tr>",s.data("config",a),t("thead",s).html(c)}}if("loadData"==a&&i(),"getData"==a)return s.data("rows");if("getConfig"==a)return s.data("config");if("getColumns"==a)return s.data("config").columns;if("unselectRow"==a&&("undefined"!=typeof e?t("tbody tr",s).eq(e).removeClass(n):t("tbody tr",s).removeClass(n)),"updateRow"==a){var p=e.index,h=s.data("config"),m=s.data("rows"),g=e.row,l=h.columns;m&&(g=t.extend(m[p],g),s.data("rows",m));var y=t(d(l,g,h));t("tbody tr",s).eq(p).after(y).remove(),r(y)}if("getSelections"==a){var m=s.data("rows"),b=[];return t("tbody tr",s).each(function(a){t(this).hasClass(n)&&b.push(m[a])}),b}if("insertRow"==a){var p=e.index||0,g=e.row,h=s.data("config"),m=s.data("rows")||[];if(!h||!g)return s;var C=t("tbody tr",s),y=t(d(h.columns,g,h)),x=C.eq(p);r(y),x.size()?x.before(y):t("tbody",s).append(y),m.splice(p,0,g)}if("deleteRow"==a&&e>-1){t("tbody tr",s).eq(e).remove();var m=s.data("rows");m.splice(e,1)}return o}}(jQuery),function(t){t.fn.tree=function(a){var e=this,o=t(e),n=Array.prototype.push,s="glyphicon-file",r="glyphicon-folder-open",d="glyphicon-folder-close",i=function(t,a,e){var o=[];!a&&o.push('<ul style="display:{0}">'.format("close"==e?"none":"block"));for(var l=0,c=t.length;c>l;l++){var u=t[l],f=u.children,v=u.id,p=u.state,h=u.attributes;o.push("<li>");var m="undefined"==typeof f?s:"close"==p?d:r;o.push('<span class="glyphicon {0}"></span> '.format(m)),o.push("<a{1}{2}{3}>{0}</a>".format(u.text,f?" class='tree-node'":"",v?" data-id='{0}'".format(v):"",h?" data-attr='{0}'".format(JSON.stringify(h)):"")),f&&n.apply(o,i(f,!1,p)),o.push("</li>")}return!a&&o.push("</ul>"),o},l=function(){t("span.glyphicon-folder-open, span.glyphicon-folder-close",o).click(function(){var a=t(this),e=a.closest("li").children("ul");a.hasClass(d)?(a.removeClass(d).addClass(r),e.show()):(a.removeClass(r).addClass(d),e.hide())})};if(a&&a.constructor==Object){var c=a.data;if(c&&c.constructor==Array){var u=i(c,!0);o.html(u.join("")),o.data("config",a),l()}var f=a.onClick;f&&t("li>a",o).click(function(){var a=t(this);attrs=a.attr("data-attr"),f.call(e,{id:a.attr("data-id"),attributes:attrs?JSON.parse(attrs):{},text:a.text()},a)})}return e}}(jQuery);